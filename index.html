<!doctype html>
<html lang="ru">
<head>
  <!-- v1.0-build-20251031-133041-UTC | Single-file GH Pages build -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ü–∏—Ä–æ–≥–æ–≤—Å–∫–∏–π –¥–≤–æ—Ä–∏–∫</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --bg:#f0fdf4; --text:#065f46; --border:#a7f3d0; }
    html,body{height:100%} body{background:var(--bg);color:var(--text)}
    .btn{display:inline-flex;align-items:center;justify-content:center;border-radius:.75rem;padding:.5rem .75rem;font-size:.875rem;font-weight:500;transition:.2s;outline:none}
    .btn:focus{box-shadow:0 0 0 2px rgba(16,185,129,.35)}
    .btn-primary{background:rgb(16 185 129);color:#fff} .btn-primary:hover{background:rgb(5 150 105)}
    .btn-ghost{background:transparent} .btn-ghost:hover{background:rgba(16,185,129,.08)}
    .btn-outline{border:1px solid var(--border)} .btn-outline:hover{background:rgba(16,185,129,.08)}
    .sheet{position:fixed;top:0;right:0;width:100%;max-width:420px;height:100%;background:#fff;box-shadow:-2px 0 24px rgba(0,0,0,.12);transform:translateX(100%);transition:transform .35s cubic-bezier(.22,1,.36,1);z-index:60}
    .sheet.open{transform:translateX(0)} .sheet-mask{position:fixed;inset:0;background:rgba(0,0,0,.18);opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:50}
    .sheet-mask.open{opacity:1;pointer-events:auto} .modal{position:fixed;inset:0;display:grid;place-items:center;background:rgba(0,0,0,.18);opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:70}
    .modal.open{opacity:1;pointer-events:auto} .card{background:rgba(255,255,255,.8);border:1px solid var(--border);border-radius:1rem}
    .badge{display:inline-flex;align-items:center;border-radius:999px;border:1px solid #34d399;color:#064e3b;padding:2px 8px;font-size:12px;line-height:1}
    .no-ls{letter-spacing:0} .fade-in{animation:fade .35s ease both}
    @keyframes fade{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <header class="sticky top-0 z-30 bg-[rgba(240,253,244,0.9)] backdrop-blur border-b border-emerald-100 shadow-sm">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <button id="btnHome" class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-2xl bg-emerald-200 grid place-items-center shadow">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
        </div>
        <div class="text-left"><h1 class="text-2xl font-bold">–ü–∏—Ä–æ–≥–æ–≤—Å–∫–∏–π –¥–≤–æ—Ä–∏–∫</h1><p class="text-sm text-emerald-700/80">–±—ã—Å—Ç—Ä–æ, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ, —ç–∫–æ–ª–æ–≥–∏—á–Ω–æ</p></div>
      </button>
      <nav class="flex gap-1 sm:gap-2 text-emerald-800 font-medium">
        <button class="btn btn-ghost" data-nav="home">–ì–ª–∞–≤–Ω–∞—è</button>
        <button class="btn btn-ghost" data-nav="menu">–ú–µ–Ω—é</button>
        <button class="btn btn-ghost" data-nav="feedback">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</button>
        <button class="btn btn-ghost" data-nav="contact">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
      </nav>
    </div>
  </header>

  <div id="orderBanner" class="max-w-4xl w-full mx-auto mt-4 px-4 hidden">
    <div class="rounded-xl border border-emerald-300 bg-emerald-100 text-emerald-900 px-4 py-2 text-sm">–°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–∫–∞–∑! –ú—ã —É–∂–µ –Ω–∞—á–∞–ª–∏ –≥–æ—Ç–æ–≤–∏—Ç—å üòä</div>
  </div>

  <main class="flex-1">
    <section id="page-home" class="max-w-4xl mx-auto text-center py-16 px-4">
      <h2 class="text-4xl font-bold mb-4 text-emerald-800">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ü–∏—Ä–æ–≥–æ–≤—Å–∫–∏–π –¥–≤–æ—Ä–∏–∫</h2>
      <p class="text-lg text-emerald-700 mb-8">–î–æ–º–∞—à–Ω—è—è –µ–¥–∞, –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–∞—è —Å –ª—é–±–æ–≤—å—é. –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–∏ –ª—é–±–∏–º—ã–µ –±–ª—é–¥–∞ –∏ –∑–∞–∫–∞–∂–∏—Ç–µ –∏—Ö –∑–∞—Ä–∞–Ω–µ–µ.</p>
      <button class="btn btn-primary px-6 py-3 text-lg" data-nav="menu">–ü–µ—Ä–µ–π—Ç–∏ –∫ –º–µ–Ω—é</button>
    </section>

    <section id="page-menu" class="max-w-6xl mx-auto px-4 py-8 hidden">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-6">
        <h2 class="text-2xl font-semibold">–ú–µ–Ω—é</h2>
        <div class="flex flex-col sm:flex-row gap-2 sm:items-center">
          <input id="search" type="search" placeholder="–ü–æ–∏—Å–∫ –±–ª—é–¥–∞‚Ä¶" class="w-full sm:w-64 bg-white/80 border border-emerald-200 rounded-xl px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-300" />
          <select id="sortBy" class="w-full sm:w-40 bg-white/80 border border-emerald-200 rounded-xl px-3 py-2">
            <option value="price">–¶–µ–Ω–∞</option><option value="calories">–ö–∞–ª–æ—Ä–∏–∏</option>
          </select>
          <button id="sortDir" class="btn btn-outline no-ls min-w-[160px]">–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</button>
        </div>
      </div>
      <div id="dishGrid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
    </section>

    <section id="page-feedback" class="max-w-4xl mx-auto px-4 py-10 hidden">
      <div class="flex items-center gap-2 mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h8M8 14h5M21 12c0 4.418-4.03 8-9 8a9.86 9.86 0 01-4-.8L3 20l.8-4A8.96 8.96 0 013 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>
        <h2 class="text-2xl font-semibold">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</h2>
      </div>
      <div id="fbBanner" class="hidden rounded-xl border border-emerald-300 bg-emerald-50 text-emerald-900 p-3 mb-4">–°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–∑—ã–≤! –û–Ω —É–∂–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∏–∂–µ.</div>
      <div class="grid md:grid-cols-2 gap-6">
        <div class="card p-4">
          <h3 class="text-lg font-semibold mb-3">–û—Å—Ç–∞–≤—å—Ç–µ –æ—Ç–∑—ã–≤</h3>
          <div class="grid gap-3">
            <div><label class="block text-sm mb-1">–ò–º—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label><input id="fbName" class="w-full bg-white/80 border border-emerald-200 rounded-xl px-3 py-2" placeholder="–í–∞—à–µ –∏–º—è" /></div>
            <div><label class="block text-sm mb-1">–ê–≤—Ç–æ–º–∞—Ç</label><select id="fbMachine" class="w-full bg-white/80 border border-emerald-200 rounded-xl px-3 py-2"></select></div>
            <div><label class="block text-sm mb-1">–ë–ª—é–¥–æ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label><select id="fbDish" class="w-full bg-white/80 border border-emerald-200 rounded-xl px-3 py-2"></select></div>
            <div><label class="block text-sm mb-1">–û—Ü–µ–Ω–∫–∞</label><select id="fbRating" class="w-full bg-white/80 border border-emerald-200 rounded-xl px-3 py-2">
              <option value="5">5 –∏–∑ 5</option><option value="4">4 –∏–∑ 5</option><option value="3">3 –∏–∑ 5</option><option value="2">2 –∏–∑ 5</option><option value="1">1 –∏–∑ 5</option>
            </select></div>
            <div><label class="block text-sm mb-1">–û—Ç–∑—ã–≤ <span class="text-xs text-emerald-700/70">(–¥–æ 300 —Å–∏–º–≤–æ–ª–æ–≤)</span></label>
              <textarea id="fbComment" rows="5" maxlength="300" class="w-full bg-white/80 border border-emerald-200 rounded-xl px-3 py-2" placeholder="–ß—Ç–æ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å? –ß—Ç–æ —É–ª—É—á—à–∏—Ç—å –≤ –µ–¥–µ –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–µ?"></textarea>
              <div class="flex items-center justify-between text-xs mt-1"><div id="fbError" class="text-red-600"></div><div><span id="fbCount">0</span>/300</div></div>
            </div>
            <div><button id="fbSend" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button></div>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="text-lg font-semibold mb-3">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã</h3>
          <div id="reviewsEmpty" class="text-sm text-emerald-800/80">–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º–∏!</div>
          <div id="reviews" class="space-y-3 mt-3"></div>
        </div>
      </div>
    </section>

    <section id="page-contact" class="max-w-4xl mx-auto text-center py-16 px-4 hidden">
      <h2 class="text-3xl font-bold mb-4 text-emerald-800">–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏</h2>
      <p class="text-lg text-emerald-700 mb-2">–¢–µ–ª–µ—Ñ–æ–Ω: +7 (000) 000-00-00</p>
      <p class="text-lg text-emerald-700 mb-6">Email: hello@pirogovskiy.example</p>
      <button class="btn btn-primary" data-nav="home">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
    </section>
  </main>

  <div id="sheetMask" class="sheet-mask"></div>
  <aside id="cartSheet" class="sheet">
    <div class="h-full flex flex-col">
      <div class="px-5 py-4 border-b border-emerald-200 flex items-center justify-between"><h3 class="text-lg font-semibold">–ö–æ—Ä–∑–∏–Ω–∞ –∑–∞–∫–∞–∑–∞</h3><button id="closeSheet" class="btn btn-ghost">–ó–∞–∫—Ä—ã—Ç—å</button></div>
      <div id="cartList" class="p-5 space-y-3 overflow-auto grow"></div>
      <div class="p-5 border-t border-emerald-100">
        <div class="flex items-center justify-between font-semibold mb-3"><span>–ò—Ç–æ–≥–æ:</span><span id="cartTotal">0 ‚ÇΩ</span></div>
        <div class="flex gap-2"><button id="btnClear" class="btn btn-outline w-1/2">–û—á–∏—Å—Ç–∏—Ç—å</button><button id="btnCheckout" class="btn btn-primary w-1/2" disabled>–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button></div>
      </div>
    </div>
  </aside>

  <div id="modal" class="modal">
    <div class="w-[92%] max-w-md card p-5 bg-white">
      <h3 class="text-lg font-semibold mb-3">–ö—É–¥–∞ –ø—Ä–∏–≤–µ–∑—Ç–∏ –∑–∞–∫–∞–∑ –∑–∞–≤—Ç—Ä–∞</h3>
      <label class="text-sm mb-1 block">–í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç</label>
      <select id="machine" class="w-full bg-white/90 border border-emerald-200 rounded-xl px-3 py-2 mb-3"></select>
      <p class="text-xs text-emerald-700/80 mb-4">–ú—ã –ø—Ä–∏–≤–µ–∑—ë–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å.</p>
      <div class="flex gap-2 justify-end"><button id="cancelCheckout" class="btn btn-outline">–û—Ç–º–µ–Ω–∞</button><button id="confirmCheckout" class="btn btn-primary">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button></div>
    </div>
  </div>

  <footer class="border-t border-emerald-100 bg-[rgba(240,253,244,0.7)] text-center py-6 text-sm text-emerald-700">
    ¬© 2025 –ü–∏—Ä–æ–≥–æ–≤—Å–∫–∏–π –¥–≤–æ—Ä–∏–∫ ‚Äî –±—ã—Å—Ç—Ä–æ, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ, —ç–∫–æ–ª–æ–≥–∏—á–Ω–æ ¬∑ v1.0-build-20251031-133041-UTC
  </footer>

  <script>
    const MACHINES=[{id:'m1',label:'–û—Å—Ç—Ä–æ–≤–∏—Ç—è–Ω–æ–≤–∞ 1—Å6 (3 —ç—Ç–∞–∂)'},{id:'m2',label:'–û—Å—Ç—Ä–æ–≤–∏—Ç—è–Ω–æ–≤–∞ 1—Å7 (2 —ç—Ç–∞–∂)'},{id:'m3',label:'–û—Å—Ç—Ä–æ–≤–∏—Ç—è–Ω–æ–≤–∞ 1—Å8 (-2 —ç—Ç–∞–∂)'}];
    const DISHES=[{id:'cz',name:'–¶–µ–∑–∞—Ä—å',price:290,calories:350},{id:'cb',name:'–ö–∞—Ä–±–æ–Ω–∞—Ä–∞',price:320,calories:520},{id:'bln',name:'–ë–ª–∏–Ω—á–∏–∫–∏',price:180,calories:300},{id:'blm',name:'–ë–ª–∏–Ω—á–∏–∫–∏ —Å –º—è—Å–æ–º',price:210,calories:370},{id:'srn',name:'–°—ã—Ä–Ω–∏–∫–∏',price:230,calories:410},{id:'vngr',name:'–í–∏–Ω–µ–≥—Ä–µ—Ç',price:170,calories:180},{id:'plv',name:'–ü–ª–æ–≤ —Å –∫—É—Ä–∏—Ü–µ–π',price:310,calories:560},{id:'ckb',name:'–ö—É—Ä–∏–Ω—ã–µ –∫–æ—Ç–ª–µ—Ç—ã —Å –±—É–ª–≥—É—Ä–æ–º',price:340,calories:520},{id:'sob',name:'–õ–∞–ø—à–∞ –≥—Ä–µ—á–Ω–µ–≤–∞—è —Å —Ü—É–∫–∏–Ω–∏ –∏ –æ—Ä–µ—Ö–æ–≤—ã–º —Å–æ—É—Å–æ–º',price:300,calories:440},{id:'vit',name:'–°–∞–ª–∞—Ç –≤–∏—Ç–∞–º–∏–Ω–Ω—ã–π',price:190,calories:160},{id:'bol',name:'–ü–∞—Å—Ç–∞ –±–æ–ª–æ–Ω—å–µ–∑–µ',price:330,calories:580},{id:'mil',name:'–ö–∞—à–∞ –ø—à–µ–Ω–Ω–∞—è —Å —Ç—ã–∫–≤–æ–π',price:200,calories:260},{id:'wok',name:'–í–æ–∫ —Å –∫—É—Ä–∏—Ü–µ–π',price:310,calories:520},{id:'bit',name:'–ë–∏—Ç–æ—á–∫–∏ –∏–∑ –∫—É—Ä–∏—Ü—ã —Å –∫–∞–ø—É—Å—Ç–æ–π',price:290,calories:430},{id:'buck',name:'–ì—Ä–µ—á–∫–∞ —Å —Ç–µ—Ñ—Ç–µ–ª—è–º–∏ –≤ —Ç–æ–º–∞—Ç–Ω–æ–º —Å–æ—É—Å–µ',price:280,calories:500},{id:'brg',name:'–ë—É—Ä–≥–µ—Ä —Å –≥–æ–≤—è–¥–∏–Ω–æ–π (—Å–Ω–∏–∂–µ–Ω–Ω–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å)',price:350,calories:470},{id:'cal',name:'–†–æ–ª–ª –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏—è',price:360,calories:430},{id:'phl',name:'–†–æ–ª–ª –§–∏–ª–∞–¥–µ–ª—å—Ñ–∏—è',price:380,calories:490},{id:'eel',name:'–†–æ–ª–ª —Å —É–≥—Ä—ë–º',price:420,calories:520},{id:'chs',name:'–ö—É—Ä–∏–Ω—ã–π —Å—É–ø —Å –ª–∞–ø—à–æ–π',price:210,calories:150},{id:'brs',name:'–ë–æ—Ä—â',price:220,calories:190}];
    const state={page:'home',query:'',sortBy:'price',sortDir:'asc',cart:[],reviews:[],orderSuccess:false};
    const fmt=n=>new Intl.NumberFormat('ru-RU').format(n)+' ‚ÇΩ',qs=s=>document.querySelector(s),ce=(t,c)=>{const e=document.createElement(t);if(c)e.className=c;return e};
    function sortDishes(l,b,d){return[...l].sort((a,b2)=>{const av=b==='price'?a.price:a.calories,bv=b==='price'?b2.price:b2.calories;return d==='asc'?av-bv:bv-av})}
    function showPage(p){state.page=p;['home','menu','feedback','contact'].forEach(id=>{qs('#page-'+id).classList.toggle('hidden',id!==p)});if(p==='home'){const banner=qs('#orderBanner');banner.classList.toggle('hidden',!state.orderSuccess);if(state.orderSuccess){setTimeout(()=>{state.orderSuccess=false;banner.classList.add('hidden')},4000)}}if(p==='menu')renderMenu()}
    function renderMenu(){const grid=qs('#dishGrid');grid.innerHTML='';const q=state.query.trim().toLowerCase();const base=q?DISHES.filter(d=>d.name.toLowerCase().includes(q)):DISHES;const list=sortDishes(base,state.sortBy,state.sortDir);list.forEach(dish=>{const card=ce('div','card p-4 hover:shadow transition-shadow fade-in');const head=ce('div','flex items-center justify-between mb-2');const name=ce('div','text-lg font-semibold');name.textContent=dish.name;head.appendChild(name);const price=ce('div','text-emerald-700 font-semibold');price.textContent=fmt(dish.price);head.appendChild(price);const kcal=ce('div','text-sm text-emerald-800');kcal.textContent=dish.calories+' –∫–∫–∞–ª'+(dish.id==='brg'?' (—Å–Ω–∏–∂–µ–Ω–Ω–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å)':'');const row=ce('div','mt-2 flex items-center gap-2');const badge=ce('span','badge');badge.textContent='–í –Ω–∞–ª–∏—á–∏–∏';const btn=ce('button','btn btn-primary ml-auto');btn.textContent='–ó–∞–∫–∞–∑–∞—Ç—å';btn.addEventListener('click',()=>addToCart(dish));card.append(head,kcal,row);row.append(badge,btn);grid.appendChild(card)})}
    const sheet=qs('#cartSheet'),sheetMask=qs('#sheetMask');function openSheet(){sheet.classList.add('open');sheetMask.classList.add('open')} function closeSheet(){sheet.classList.remove('open');sheetMask.classList.remove('open')}
    function addToCart(d){const idx=state.cart.findIndex(i=>i.id===d.id);if(idx>=0)state.cart[idx].qty+=1;else state.cart.push({id:d.id,name:d.name,price:d.price,qty:1});renderCart();openSheet()}
    function inc(id){const it=state.cart.find(i=>i.id===id);if(it){it.qty+=1;renderCart()}} function dec(id){const it=state.cart.find(i=>i.id===id);if(it){it.qty=Math.max(1,it.qty-1);renderCart()}} function removeItem(id){state.cart=state.cart.filter(i=>i.id!==id);renderCart()} function clearCart(){state.cart=[];renderCart()}
    function renderCart(){const list=qs('#cartList');list.innerHTML='';const total=state.cart.reduce((s,i)=>s+i.price*i.qty,0);qs('#cartTotal').textContent=fmt(total);qs('#btnCheckout').disabled=state.cart.length===0;if(state.cart.length===0){const empty=ce('div','text-sm text-emerald-800/80');empty.textContent='–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞. –î–æ–±–∞–≤—å—Ç–µ –±–ª—é–¥–æ –∏–∑ –º–µ–Ω—é.';list.appendChild(empty);return} state.cart.forEach(item=>{const row=ce('div','rounded-xl border border-emerald-200 p-3 bg-emerald-50/40');const wrap=ce('div','flex items-center justify-between');const left=ce('div');const nm=ce('div','font-medium');nm.textContent=item.name;left.appendChild(nm);const pr=ce('div','text-sm text-emerald-700');pr.textContent=fmt(item.price)+' √ó '+item.qty;left.appendChild(pr);const right=ce('div','flex items-center gap-2');const bDec=ce('button','btn btn-outline');bDec.textContent='-';bDec.addEventListener('click',()=>dec(item.id));const bInc=ce('button','btn btn-outline');bInc.textContent='+';bInc.addEventListener('click',()=>inc(item.id));const bRem=ce('button','btn btn-ghost');bRem.textContent='–£–±—Ä–∞—Ç—å';bRem.addEventListener('click',()=>removeItem(item.id));right.append(bDec,bInc,bRem);wrap.append(left,right);row.appendChild(wrap);list.appendChild(row)})}
    function fillMachines(select){select.innerHTML='';MACHINES.forEach(m=>{const o=ce('option');o.value=m.id;o.textContent=m.label;select.appendChild(o)})}
    function fillFeedbackSelects(){const fbMachine=qs('#fbMachine'),fbDish=qs('#fbDish');fbMachine.innerHTML='';MACHINES.forEach(m=>{const o=ce('option');o.value=m.id;o.textContent=m.label;fbMachine.appendChild(o)});fbDish.innerHTML='';const none=ce('option');none.value='none';none.textContent='‚Äî –Ω–µ –≤—ã–±—Ä–∞–Ω–æ ‚Äî';fbDish.appendChild(none);DISHES.forEach(d=>{const o=ce('option');o.value=d.id;o.textContent=d.name;fbDish.appendChild(o)})}
    function submitFeedback(){const name=qs('#fbName').value.trim()||'–ê–Ω–æ–Ω–∏–º';const machineId=qs('#fbMachine').value;const dishVal=qs('#fbDish').value;const dishId=dishVal!=='none'?dishVal:undefined;const rating=Number(qs('#fbRating').value);const commentEl=qs('#fbComment');const errorEl=qs('#fbError');const comment=commentEl.value.trim();if(!comment){errorEl.textContent='–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –ø–∞—Ä—É —Å–ª–æ–≤ –≤ –æ—Ç–∑—ã–≤–µ.';return} if(comment.length>300){errorEl.textContent='–ú–∞–∫—Å–∏–º—É–º 300 —Å–∏–º–≤–æ–ª–æ–≤.';return} errorEl.textContent='';const review={id:Math.random().toString(36).slice(2),name,machineId,rating,comment,dishId,createdAt:new Date().toISOString()};state.reviews=[review,...state.reviews];qs('#fbName').value='';qs('#fbComment').value='';qs('#fbCount').textContent='0';qs('#fbDish').value='none';qs('#fbRating').value='5';qs('#fbMachine').value='m1';qs('#fbBanner').classList.remove('hidden');renderReviews()}
    function renderReviews(){const list=qs('#reviews'),empty=qs('#reviewsEmpty');list.innerHTML='';empty.classList.toggle('hidden',state.reviews.length>0);state.reviews.forEach(r=>{const it=ce('div','rounded-xl border border-emerald-200 p-3 bg-emerald-50/40');const top=ce('div','flex items-center justify-between');const nm=ce('div','font-medium');nm.textContent=r.name;const dt=ce('div','text-xs text-emerald-700/80');dt.textContent=new Date(r.createdAt).toLocaleString('ru-RU');top.append(nm,dt);const stars=ce('div','text-sm text-emerald-800/90 mt-1');stars.textContent='–û—Ü–µ–Ω–∫–∞: '+'‚òÖ'.repeat(r.rating)+'‚òÜ'.repeat(5-r.rating);const mach=ce('div','text-sm text-emerald-800/90');mach.textContent='–ê–≤—Ç–æ–º–∞—Ç: '+(MACHINES.find(m=>m.id===r.machineId)?.label||'');it.append(top,stars,mach);if(r.dishId){const d=DISHES.find(d=>d.id===r.dishId)?.name;const dn=ce('div','text-sm text-emerald-800/90');dn.textContent='–ë–ª—é–¥–æ: '+(d||'');it.appendChild(dn)}const cm=ce('div','mt-2 text-emerald-900');cm.textContent=r.comment;it.appendChild(cm);list.appendChild(it)})}
    const modal=qs('#modal');function openModal(){modal.classList.add('open')} function closeModal(){modal.classList.remove('open')}
    document.querySelectorAll('[data-nav]').forEach(btn=>btn.addEventListener('click',e=>showPage(e.currentTarget.getAttribute('data-nav'))));
    qs('#btnHome').addEventListener('click',()=>showPage('home'));
    qs('#search').addEventListener('input',e=>{state.query=e.target.value;renderMenu()});
    qs('#sortBy').addEventListener('change',e=>{state.sortBy=e.target.value;renderMenu()});
    qs('#sortDir').addEventListener('click',()=>{state.sortDir=state.sortDir==='asc'?'desc':'asc';qs('#sortDir').textContent=state.sortDir==='asc'?'–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é':'–ø–æ —É–±—ã–≤–∞–Ω–∏—é';renderMenu()});
    qs('#closeSheet').addEventListener('click',closeSheet); qs('#sheetMask').addEventListener('click',closeSheet);
    qs('#btnClear').addEventListener('click',clearCart);
    qs('#btnCheckout').addEventListener('click',()=>{fillMachines(qs('#machine'));openModal()});
    qs('#cancelCheckout').addEventListener('click',closeModal);
    qs('#confirmCheckout').addEventListener('click',()=>{closeModal();closeSheet();clearCart();state.orderSuccess=true;showPage('home')});
    qs('#fbComment').addEventListener('input',e=>{const v=e.target.value; if(v.length>300)e.target.value=v.slice(0,300);qs('#fbCount').textContent=e.target.value.length;qs('#fbError').textContent=''});
    qs('#fbSend').addEventListener('click',submitFeedback);
    function init(){showPage('home');renderMenu();fillMachines(qs('#machine'));fillFeedbackSelects();const noneOK=!!document.querySelector('#fbDish option[value="none"]');console.assert(noneOK,'TEST: fbDish sentinel none');const a=sortDishes(DISHES,'price','asc');console.assert(a[0].price<=a[a.length-1].price,'TEST: asc');const d=sortDishes(DISHES,'calories','desc');console.assert(d[0].calories>=d[d.length-1].calories,'TEST: desc')} init();
  </script>
</body>
</html>
