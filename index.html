<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>–ü–∏—Ä–æ–≥–æ–≤—Å–∫–∏–π –¥–≤–æ—Ä–∏–∫</title>
    <meta name="description" content="–ë—ã—Å—Ç—Ä–æ, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ, —ç–∫–æ–ª–æ–≥–∏—á–Ω–æ. –ü–∏—Ä–æ–≥–æ–≤—Å–∫–∏–π –¥–≤–æ—Ä–∏–∫ ‚Äî –¥–æ–º–∞—à–Ω–∏–µ –±–ª—é–¥–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∞—Ö –Ω–∞ –û—Å—Ç—Ä–æ–≤–∏—Ç—è–Ω–æ–≤–∞." />
    <meta name="theme-color" content="#d9f99d" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="format-detection" content="telephone=no" />

    <!-- Tailwind for styling -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React 18 + ReactDOM 18 (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <style>
      html, body { height: 100%; }
      body {
        background: linear-gradient(to bottom, #f0fdf4, #f7fee7);
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
      }
      * { -webkit-tap-highlight-color: rgba(0,0,0,0); }
      input, select, button { font-size: 16px; }
      .ios-scroll { -webkit-overflow-scrolling: touch; }
      .tap { min-height: 44px; }
      .safe-top { padding-top: max(env(safe-area-inset-top), 0.5rem); }
      .safe-bottom { padding-bottom: max(env(safe-area-inset-bottom), 0.5rem); }
      .badge { min-width: 1.5rem; height: 1.5rem; line-height: 1.5rem; }
    </style>
  </head>
  <body class="min-h-screen text-green-950">
    <div id="root"></div>

    <script>
      (function(){
        const h = React.createElement;
        const { useMemo, useState } = React;

        const MACHINES = [
          { id: "ost-1s6", name: "–û—Å—Ç—Ä–æ–≤–∏—Ç—è–Ω–æ–≤–∞ 1—Å6 (3 —ç—Ç–∞–∂)" },
          { id: "ost-1s7", name: "–û—Å—Ç—Ä–æ–≤–∏—Ç—è–Ω–æ–≤–∞ 1—Å7 (2 —ç—Ç–∞–∂)" },
          { id: "ost-1s8", name: "–û—Å—Ç—Ä–æ–≤–∏—Ç—è–Ω–æ–≤–∞ 1—Å8 (-2 —ç—Ç–∞–∂)" },
        ];

        const DISHES_BASE = [
          { name: "–¶–µ–∑–∞—Ä—å", price: 320, kcal: 380 },
          { name: "–ö–∞—Ä–±–æ–Ω–∞—Ä–∞", price: 360, kcal: 620 },
          { name: "–ë–ª–∏–Ω—á–∏–∫–∏", price: 180, kcal: 290 },
          { name: "–ë–ª–∏–Ω—á–∏–∫–∏ —Å –º—è—Å–æ–º", price: 220, kcal: 360 },
          { name: "–°—ã—Ä–Ω–∏–∫–∏", price: 240, kcal: 410 },
          { name: "–í–∏–Ω–µ–≥—Ä–µ—Ç", price: 170, kcal: 210 },
          { name: "–ü–ª–æ–≤ —Å –∫—É—Ä–∏—Ü–µ–π", price: 340, kcal: 560 },
          { name: "–ö—É—Ä–∏–Ω—ã–µ –∫–æ—Ç–ª–µ—Ç—ã —Å –±—É–ª–≥—É—Ä–æ–º", price: 350, kcal: 520 },
          { name: "–õ–∞–ø—à–∞ –≥—Ä–µ—á–Ω–µ–≤–∞—è —Å —Ü—É–∫–∏–Ω–∏ –∏ –æ—Ä–µ—Ö–æ–≤—ã–º —Å–æ—É—Å–æ–º", price: 330, kcal: 480 },
          { name: "–°–∞–ª–∞—Ç –≤–∏—Ç–∞–º–∏–Ω–Ω—ã–π", price: 190, kcal: 170 },
          { name: "–ü–∞—Å—Ç–∞ –±–æ–ª–æ–Ω—å–µ–∑–µ", price: 360, kcal: 640 },
          { name: "–ö–∞—à–∞ –ø—à–µ–Ω–Ω–∞—è —Å —Ç—ã–∫–≤–æ–π", price: 210, kcal: 300 },
          { name: "–í–æ–∫ —Å –∫—É—Ä–∏—Ü–µ–π", price: 340, kcal: 550 },
          { name: "–ë–∏—Ç–æ—á–∫–∏ –∏–∑ –∫—É—Ä–∏—Ü—ã —Å –∫–∞–ø—É—Å—Ç–æ–π", price: 320, kcal: 460 },
          { name: "–ì—Ä–µ—á–∫–∞ —Å —Ç–µ—Ñ—Ç–µ–ª—è–º–∏ –≤ —Ç–æ–º–∞—Ç–Ω–æ–º —Å–æ—É—Å–µ", price: 330, kcal: 530 },
          { name: "–ë—É—Ä–≥–µ—Ä —Å –≥–æ–≤—è–¥–∏–Ω–æ–π (—Å–Ω–∏–∂–µ–Ω–Ω–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å)", price: 390, kcal: 480 },
          { name: "–ë–æ—Ä—â", price: 220, kcal: 180 },
          { name: "–†–æ–ª–ª –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏—è", price: 380, kcal: 420 },
          { name: "–†–æ–ª–ª –§–∏–ª–∞–¥–µ–ª—å—Ñ–∏—è", price: 420, kcal: 480 },
          { name: "–†–æ–ª–ª —Å —É–≥—Ä–µ–º", price: 430, kcal: 500 },
          { name: "–ö—É—Ä–∏–Ω—ã–π —Å—É–ø —Å –ª–∞–ø—à–æ–π", price: 240, kcal: 220 },
        ];

        const DISHES = DISHES_BASE.map((d, i) => ({
          id: "dish-" + (i + 1),
          ...d,
          stock: {
            "ost-1s6": Math.random() > 0.35 ? Math.floor(Math.random() * 6) : 0,
            "ost-1s7": Math.random() > 0.35 ? Math.floor(Math.random() * 6) : 0,
            "ost-1s8": Math.random() > 0.35 ? Math.floor(Math.random() * 6) : 0,
          },
        }));

        function formatRub(n) {
          return new Intl.NumberFormat("ru-RU", { style: "currency", currency: "RUB", maximumFractionDigits: 0 }).format(n);
        }

        function nextDayLocalISO() {
          const now = new Date();
          const next = new Date(now);
          next.setDate(now.getDate() + 1);
          next.setHours(9, 0, 0, 0);
          return next.toISOString();
        }

        function App(){
          const [query, setQuery] = useState("");
          const [sortBy, setSortBy] = useState("price");
          const [sortDir, setSortDir] = useState("asc");
          const [onlyInStock, setOnlyInStock] = useState(false);
          const [machineFilter, setMachineFilter] = useState(new Set(MACHINES.map(m => m.id)));
          const [orderOpen, setOrderOpen] = useState(false);
          const [basket, setBasket] = useState({}); // { [dishId]: { qty: number, toMachineId: string } }
          const [confirm, setConfirm] = useState(null);

          const filtered = useMemo(function(){
            const machines = Array.from(machineFilter);
            const list = DISHES.filter(function(d){
              const matches = d.name.toLowerCase().includes(query.toLowerCase());
              const stockSum = machines.reduce((acc, id) => acc + (d.stock[id] || 0), 0);
              const okStock = !onlyInStock || stockSum > 0;
              return matches && okStock;
            }).sort(function(a,b){
              const key = sortBy === "price" ? "price" : "kcal";
              const dir = sortDir === "asc" ? 1 : -1;
              return (a[key] - b[key]) * dir;
            });
            return list;
          }, [query, sortBy, sortDir, onlyInStock, machineFilter]);

          const basketTotal = useMemo(function(){
            return Object.entries(basket).reduce(function(sum, kv){
              const dishId = kv[0]; const item = kv[1];
              const dish = DISHES.find(d => d.id === dishId);
              return sum + (dish ? dish.price * item.qty : 0);
            }, 0);
          }, [basket]);

          const basketCount = useMemo(function(){
            return Object.values(basket).reduce(function(n, it){ return n + (it.qty || 0); }, 0);
          }, [basket]);

          const nextDayIso = React.useMemo(nextDayLocalISO, []);
          const nextDayFmt = React.useMemo(function(){
            return new Date(nextDayIso).toLocaleString("ru-RU", { dateStyle: "long", timeStyle: "short" });
          }, [nextDayIso]);

          function toggleMachine(id){
            setMachineFilter(function(prev){
              const c = new Set(prev);
              if (c.has(id)) c.delete(id); else c.add(id);
              return c;
            });
          }

          function addToBasket(dishId, toMachineId){
            setBasket(function(prev){
              const curr = prev[dishId] || { qty: 0, toMachineId: toMachineId };
              const copy = Object.assign({}, prev);
              copy[dishId] = { qty: (curr.qty || 0) + 1, toMachineId: toMachineId || curr.toMachineId };
              return copy;
            });
            setOrderOpen(true);
          }

          function incInBasket(dishId){
            setBasket(function(prev){
              const curr = prev[dishId]; if (!curr) return prev;
              const copy = Object.assign({}, prev); copy[dishId] = { qty: curr.qty + 1, toMachineId: curr.toMachineId }; return copy;
            });
          }

          function decFromBasket(dishId){
            setBasket(function(prev){
              const curr = prev[dishId];
              if (!curr) return prev;
              const q = curr.qty - 1;
              const copy = Object.assign({}, prev);
              if (q <= 0) { delete copy[dishId]; } else { copy[dishId] = { qty: q, toMachineId: curr.toMachineId }; }
              return copy;
            });
          }

          function changeBasketMachine(dishId, machineId){
            setBasket(function(prev){
              const curr = prev[dishId] || { qty: 1, toMachineId: machineId };
              const copy = Object.assign({}, prev);
              copy[dishId] = { qty: curr.qty, toMachineId: machineId };
              return copy;
            });
          }

          function submitOrder(){
            const payload = Object.entries(basket).map(function(kv){
              const dishId = kv[0]; const item = kv[1];
              const dish = DISHES.find(d => d.id === dishId);
              const machine = MACHINES.find(m => m.id === item.toMachineId);
              return { dish: dish && dish.name, qty: item.qty, toMachine: machine && machine.name };
            });
            setConfirm({ items: payload, total: basketTotal, eta: nextDayFmt });
            setBasket({});
            setOrderOpen(false);
          }

          // ---- Components ----
          function Header(){
            return h("header", { className: "sticky top-0 z-30 backdrop-blur bg-white/70 border-b border-lime-200/60 safe-top" },
              h("div", { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between" },
                h("div", { className: "flex items-center gap-3" },
                  h("div", { className: "w-10 h-10 rounded-2xl bg-lime-200 flex items-center justify-center shadow" }, "üçÉ"),
                  h("div", null,
                    h("h1", { className: "text-xl sm:text-2xl font-bold tracking-tight" }, "–ü–∏—Ä–æ–≥–æ–≤—Å–∫–∏–π –¥–≤–æ—Ä–∏–∫"),
                    h("p", { className: "text-xs sm:text-sm text-green-700" }, "–±—ã—Å—Ç—Ä–æ, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ, —ç–∫–æ–ª–æ–≥–∏—á–Ω–æ")
                  )
                ),
                h("div", { className: "hidden md:flex items-center gap-3 text-sm" },
                  h("div", { className: "flex items-center gap-2 text-green-700" }, "üìç –û—Å—Ç—Ä–æ–≤–∏—Ç—è–Ω–æ–≤–∞ 1—Å6 ¬∑ 1—Å7 ¬∑ 1—Å8"),
                  h("button", { onClick: function(){ setOrderOpen(true); }, className: "relative tap px-4 py-2 rounded-2xl shadow bg-lime-300 hover:bg-lime-400 transition" },
                    "üß∫ –ö–æ—Ä–∑–∏–Ω–∞",
                    basketCount ? h("span", { className: "absolute -top-2 -right-2 badge rounded-full bg-green-700 text-white text-xs px-1 text-center" }, String(basketCount)) : null
                  )
                )
              )
            );
          }

          function Filters(){
            return h("section", { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6" },
              h("div", { className: "grid md:grid-cols-4 gap-3 sm:gap-4 items-end bg-white/70 rounded-2xl p-3 sm:p-4 shadow-sm border border-lime-200" },
                h("div", { className: "md:col-span-2" },
                  h("label", { htmlFor: "search", className: "text-green-800 text-sm" }, "–ü–æ–∏—Å–∫ –±–ª—é–¥–∞"),
                  h("input", {
                    id: "search", placeholder: "–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–æ—Ä—â", value: query,
                    onChange: function(e){ setQuery(e.target.value); },
                    className: "tap mt-1 w-full bg-white/80 rounded-xl border border-lime-200 px-3 py-2"
                  })
                ),
                h("div", null,
                  h("label", { className: "text-green-800 text-sm" }, "–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞"),
                  h("div", { className: "flex gap-2 mt-1" },
                    h("select", {
                      value: sortBy, onChange: function(e){ setSortBy(e.target.value); },
                      className: "tap rounded-xl bg-white/80 border border-lime-200 px-3 py-2 w-full"
                    },
                      h("option", { value: "price" }, "–ü–æ —Ü–µ–Ω–µ"),
                      h("option", { value: "kcal" }, "–ü–æ –∫–∞–ª–æ—Ä–∏—è–º")
                    ),
                    h("select", {
                      value: sortDir, onChange: function(e){ setSortDir(e.target.value); },
                      className: "tap rounded-xl bg-white/80 border border-lime-200 px-3 py-2 w-full"
                    },
                      h("option", { value: "asc" }, "–í–æ–∑—Ä."),
                      h("option", { value: "desc" }, "–£–±—ã–≤.")
                    )
                  )
                ),
                h("div", { className: "flex items-center gap-3 p-3 rounded-xl bg-white/80 border border-lime-200" },
                  h("span", { "aria-hidden": "true" }, "üîé"),
                  h("label", { htmlFor: "instock", className: "text-green-800 flex-1" }, "–¢–æ–ª—å–∫–æ –≤ –Ω–∞–ª–∏—á–∏–∏"),
                  h("input", {
                    id: "instock", type: "checkbox", checked: onlyInStock,
                    onChange: function(e){ setOnlyInStock(e.target.checked); },
                    className: "tap w-6 h-6"
                  })
                ),
                h("div", { className: "md:col-span-4" },
                  h("label", { className: "text-green-800 text-sm" }, "–ê–≤—Ç–æ–º–∞—Ç—ã"),
                  h("div", { className: "flex flex-wrap gap-2 mt-2" },
                    MACHINES.map(function(m){
                      const active = machineFilter.has(m.id);
                      const cls = "tap px-3 py-2 rounded-full border transition shadow-sm " + (active ? "bg-lime-200 border-lime-300" : "bg-white border-lime-200 text-green-700");
                      return h("button", {
                        key: m.id, className: cls, "aria-pressed": active,
                        onClick: function(){ toggleMachine(m.id); }
                      }, m.name);
                    })
                  )
                )
              )
            );
          }

          function DishCard(d){
            return h("div", { key: d.id, className: "rounded-2xl border border-lime-200 bg-white/80 shadow-sm hover:shadow-md transition" },
              h("div", { className: "p-4 sm:p-5" },
                h("div", { className: "flex items-start justify-between gap-3" },
                  h("h3", { className: "text-base sm:text-lg font-semibold text-green-950 leading-tight" }, d.name),
                  h("span", { className: "inline-flex items-center px-2.5 py-1 rounded-xl bg-lime-100 text-green-900 text-sm font-medium" }, formatRub(d.price))
                ),
                h("p", { className: "text-sm text-green-700 mt-1" }, d.kcal + " –∫–∫–∞–ª"),
                h("div", { className: "my-3 h-px bg-lime-200" }),
                h("div", { className: "space-y-2" },
                  MACHINES.map(function(m){
                    const count = d.stock[m.id] || 0;
                    const available = count > 0;
                    const inFilter = machineFilter.has(m.id);
                    const rowCls = "flex items-center justify-between text-sm " + (inFilter ? "" : "opacity-50");
                    const dotCls = "inline-flex items-center justify-center w-6 h-6 rounded-full " + (available ? "bg-lime-300" : "bg-lime-100");
                    return h("div", { key: m.id, className: rowCls },
                      h("div", { className: "flex items-center gap-2" },
                        h("span", { className: dotCls }, available ? "‚úî" : "i"),
                        h("span", null, m.name)
                      ),
                      h("div", { className: "flex items-center gap-2" },
                        h("span", { className: "text-green-800" }, available ? (count + " —à—Ç.") : "–Ω–µ—Ç"),
                        h("button", {
                          disabled: !inFilter,
                          className: "tap px-3 py-2 rounded-xl border border-lime-200 bg-white hover:bg-lime-50 disabled:opacity-50",
                          onClick: function(){ addToBasket(d.id, m.id); }
                        }, "–ó–∞–∫–∞–∑")
                      )
                    );
                  })
                )
              )
            );
          }

          function DishGrid(){
            return h("main", { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-24 sm:pb-12" },
              h("div", { className: "grid sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5" },
                filtered.map(DishCard)
              )
            );
          }

          function Footer(){
            return h("footer", { className: "bg-white/70 border-t border-lime-200 py-8" },
              h("div", { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" },
                h("h4", { className: "text-lg font-semibold text-green-950 mb-3" }, "–ê–¥—Ä–µ—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–æ–≤"),
                h("div", { className: "grid md:grid-cols-3 gap-4 text-green-900" },
                  MACHINES.map(function(m){
                    return h("div", { key: m.id, className: "rounded-2xl bg-lime-100 p-4 border border-lime-200 shadow-sm" },
                      h("div", { className: "flex items-center gap-2" }, "üìç", h("span", null, m.name)),
                      h("p", { className: "text-sm text-green-800 mt-2" }, "–†–∞–±–æ—Ç–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω–æ. –ó–∞–∫–∞–∑ –ø—Ä–∏–≤–æ–∑–∏–º –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –∫ 09:00.")
                    );
                  })
                ),
                h("p", { className: "text-xs text-green-700 mt-6" }, "¬© " + new Date().getFullYear() + " ¬´–ü–∏—Ä–æ–≥–æ–≤—Å–∫–∏–π –¥–≤–æ—Ä–∏–∫¬ª. –î–æ–º–∞—à–Ω–∏–π —Å—Ç–∏–ª—å, –ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ –∑–µ–ª—ë–Ω–æ‚Äë—Å–∞–ª–∞—Ç–æ–≤—ã–µ —Ç–æ–Ω–∞.")
              )
            );
          }

          function MobileCartButton(){
            return h("div", { className: "fixed md:hidden bottom-4 right-4 safe-bottom" },
              h("button", { onClick: function(){ setOrderOpen(true); }, className: "relative tap px-4 py-3 rounded-2xl shadow-lg bg-lime-300" },
                "üß∫ –ö–æ—Ä–∑–∏–Ω–∞",
                basketCount ? h("span", { className: "absolute -top-2 -right-2 badge rounded-full bg-green-700 text-white text-xs px-1 text-center" }, String(basketCount)) : null
              )
            );
          }

          function OrderSheet(){
            if (!orderOpen) return null;
            const entries = Object.entries(basket);
            return h("div", { className: "fixed inset-0 z-40" },
              h("div", { className: "absolute inset-0 bg-black/30", onClick: function(){ setOrderOpen(false); } }),
              h("div", { className: "absolute right-0 top-0 h-full w-full sm:max-w-md bg-white shadow-xl rounded-l-2xl p-4 sm:p-5 flex flex-col" },
                h("div", { className: "flex items-center justify-between" },
                  h("h2", { className: "text-lg sm:text-xl font-semibold" }, "–ó–∞–∫–∞–∑ –Ω–∞ –∑–∞–≤—Ç—Ä–∞"),
                  h("button", { className: "tap px-3 py-1 rounded-xl", onClick: function(){ setOrderOpen(false); }, "aria-label": "–ó–∞–∫—Ä—ã—Ç—å" }, "‚úï")
                ),
                h("p", { className: "text-sm text-green-700 mt-1" }, "–î–æ—Å—Ç–∞–≤–∏–º –∫ " + nextDayFmt + ". –í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏."),
                h("div", { className: "mt-4 space-y-4 flex-1 overflow-auto ios-scroll" },
                  entries.length === 0
                    ? h("p", { className: "text-sm text-green-800" }, "–ü–æ–∫–∞ –ø—É—Å—Ç–æ. –î–æ–±–∞–≤—å—Ç–µ –±–ª—é–¥–∞ –∏–∑ —Å–ø–∏—Å–∫–∞.")
                    : entries.map(function(kv){
                        const dishId = kv[0]; const value = kv[1];
                        const qty = value.qty; const toMachineId = value.toMachineId;
                        const dish = DISHES.find(function(x){ return x.id === dishId; });
                        return h("div", { key: dishId, className: "rounded-xl border border-lime-200 p-3 bg-lime-50/60" },
                          h("div", { className: "flex items-start justify-between gap-3" },
                            h("div", null,
                              h("div", { className: "font-medium leading-tight" }, dish && dish.name),
                              h("div", { className: "text-sm text-green-700 mt-0.5" }, formatRub((dish && dish.price) || 0) + " ¬∑ " + ((dish && dish.kcal) || 0) + " –∫–∫–∞–ª")
                            ),
                            h("div", { className: "flex items-center gap-2" },
                              h("button", { onClick: function(){ decFromBasket(dishId); }, className: "tap px-3 py-1 rounded-xl border", "aria-label": "–£–±–∞–≤–∏—Ç—å" }, "‚àí"),
                              h("span", { className: "w-8 text-center" }, String(qty)),
                              h("button", { onClick: function(){ incInBasket(dishId); }, className: "tap px-3 py-1 rounded-xl border", "aria-label": "–î–æ–±–∞–≤–∏—Ç—å" }, "+")
                            )
                          ),
                          h("div", { className: "mt-3" },
                            h("label", { className: "text-green-800 text-sm" }, "–ê–≤—Ç–æ–º–∞—Ç"),
                            h("select", {
                              value: toMachineId,
                              onChange: function(e){ changeBasketMachine(dishId, e.target.value); },
                              className: "tap mt-1 w-full rounded-xl border px-3 py-2"
                            },
                              MACHINES.map(function(m){
                                return h("option", { key: m.id, value: m.id }, m.name);
                              })
                            )
                          )
                        );
                      })
                ),
                h("div", { className: "mt-4" },
                  h("div", { className: "my-3 h-px bg-lime-200" }),
                  h("div", { className: "flex items-center justify-between font-semibold" },
                    h("span", null, "–ò—Ç–æ–≥–æ"),
                    h("span", null, formatRub(basketTotal))
                  )
                ),
                h("div", { className: "mt-4 flex gap-2" },
                  h("button", { onClick: function(){ setOrderOpen(false); }, className: "tap px-4 py-2 rounded-xl border" }, "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤—ã–±–æ—Ä"),
                  h("button", {
                    disabled: Object.keys(basket).length === 0,
                    onClick: submitOrder,
                    className: "tap px-4 py-2 rounded-xl bg-lime-300 disabled:opacity-50"
                  }, "–û—Ñ–æ—Ä–º–∏—Ç—å –Ω–∞ –∑–∞–≤—Ç—Ä–∞")
                )
              )
            );
          }

          function ConfirmDialog(){
            if (!confirm) return null;
            return h("div", { className: "fixed inset-0 z-50" },
              h("div", { className: "absolute inset-0 bg-black/30", onClick: function(){ setConfirm(null); } }),
              h("div", { className: "absolute inset-0 m-auto h-max w-[min(92vw,480px)] bg-white rounded-2xl p-5 shadow-xl" },
                h("div", { className: "flex items-center justify-between" },
                  h("h3", { className: "text-lg font-semibold" }, "–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω"),
                  h("button", { className: "tap px-3 py-1 rounded-xl", onClick: function(){ setConfirm(null); } }, "–û–∫")
                ),
                h("p", { className: "text-sm text-green-700 mt-1" }, "–ú—ã –ø—Ä–∏–≤–µ–∑—ë–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –±–ª—é–¥–∞ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã –∫ " + confirm.eta + "."),
                h("div", { className: "mt-3 space-y-2 max-h-64 overflow-auto ios-scroll" },
                  confirm.items.map(function(it, i){
                    return h("div", { key: i, className: "flex items-center justify-between text-sm" },
                      h("span", null, it.dish + " √ó " + it.qty),
                      h("span", { className: "text-green-800" }, it.toMachine)
                    );
                  }),
                  h("div", { className: "my-2 h-px bg-lime-200" }),
                  h("div", { className: "flex items-center justify-between font-semibold" },
                    h("span", null, "–ò—Ç–æ–≥–æ"),
                    h("span", null, formatRub(confirm.total || 0))
                  )
                )
              )
            );
          }

          function AppView(){
            return h(React.Fragment, null,
              h(Header, null),
              h(Filters, null),
              h(DishGrid, null),
              h(Footer, null),
              h(MobileCartButton, null),
              h(OrderSheet, null),
              h(ConfirmDialog, null)
            );
          }

          // Render after DOM ready (helps iOS Safari)
          function mount(){
            if (!window.ReactDOM || !document.getElementById("root")) return;
            const root = ReactDOM.createRoot(document.getElementById("root"));
            root.render(h(AppView));
          }
          if (document.readyState === "loading"){
            document.addEventListener("DOMContentLoaded", mount);
          } else {
            mount();
          }
        })();
    </script>
  </body>
</html>
